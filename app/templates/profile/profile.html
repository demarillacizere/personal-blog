{% extends 'base.html'%}

{% block content %}
<div class="container">
<div class="row">
    <button class="btn btn-outline-info"><a href="{{url_for('main.new_blog')}}"><i class="fas fa-plus"></i>  New post</a></button></br><br>
  <!--Display profile photo-->
  <div class="col-md-4">

    {% if user.profile_pic_path %}

    <img src="{{url_for('static',filename=user.profile_pic_path)}}" alt="" class="img-thumbnail">

    {%else%}
    <p>No profile picture</p>
    {% endif %}

        {% if user == current_user %}
    <form  action="{{url_for('main.update_pic',uname=user.username)}}" method="post" enctype = "multipart/form-data">

      <input class='form-control' type="file"  name="photo" class="form-control" required><br>
      <button class='btn btn-info form-control' type="submit">Submit</button><br><br>
      <button class='btn btn-success form-control'><a href="{{url_for('main.update_profile',uname=user.username)}}">Edit profile</a></button><br><br><br><br>
    </form>
      {% endif %}
  </div>
  <div class="col-md-7">
    <table class="table table-striped table-light">
      <tbody>
        <h2><h3> {{user.username| capitalize}} </h3></h2>
      <tr>
        <th scope="row">Bio:</th>
          <td>{% if user.bio %}
            {{user.bio}}
          {%else%}
            You have no bio
          {% endif %}</td>
      </tr>
      <tr>
        <th scope="row">blogs</th>
        <td>{{user.blogs.count()}}</td>
      </tr>
      </tbody>
    </table>
    <div>
      <h3 class='text-center'><strong>My blogs</strong></h3><br>
        {% if user.blogs %}
		{% for blog in user.blogs %}
		<div class="col-md-4">
			<div class="panel" style='padding:7px;background-color: rgb(225, 226, 241);box-shadow: 1px 1px 5px rgb(162, 218, 240);'>
				<div class="card-body">
					<h4 class="card-title">{{blog.title}}</h4><hr>
					<p class="card-text">{{blog.content}}</p>
                    <p>Posted on {{blog.posted.strftime('%b %d, %Y')}} by {{blog.user.username| capitalize}}</p>
					<div class='card-footer'>
						<a href="{{url_for('main.comment',blog_id = blog.id)}}"><span><i class="fa fa-comment"></i>{{blog.comments.count()}}</span></a>&nbsp;
            <span><a href="{{url_for('main.like',blog_id = blog.id)}}"><i class="fa fa-thumbs-up"></i></a>{{blog.likes.count()}}</span>&nbsp;
            <span><a href="{{url_for('main.dislike',blog_id = blog.id)}}"><i class="fa fa-thumbs-down"></i></a>{{blog.dislikes.count()}}</span>&nbsp;
            <a href="{{url_for('main.delete',blog_id = blog.id)}}"><button class='btn btn-danger'>Delete post</button></a>
            <a href="{{url_for('main.update_post',blog_id = blog.id)}}"><button class='btn btn-danger'>Edit</button></a>
          </div>
				</div>
            </div>
    </div>
		{% endfor %}
		{% else %}
		<button class="btn btn-outline-info"><a href="{{url_for('main.new_blog')}}"><i class="fas fa-plus"></i>  Add your first blog</a></button></br><br>
		{% endif %}
    </div>
  </div>
</div>
</div>
<footer class='footer' style='position:fixed;left:0;bottom:0;background-color:rgb(15, 40, 61);padding:15px;text-align:center;width:100%;color:white;'>Copyright 2020 | blogIt</footer> 
{% endblock %}